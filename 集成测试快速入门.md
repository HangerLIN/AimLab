# 集成测试快速入门

## 🚀 5分钟快速开始

### 步骤1: 准备数据库

```bash
# 登录 MySQL
mysql -u root -p

# 创建/更新测试数据库
DROP DATABASE IF EXISTS aimlab;
CREATE DATABASE aimlab CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE aimlab;

# 运行建表脚本
SOURCE src/main/resources/sql/schema.sql;
```

### 步骤2: 运行测试

```bash
# 运行所有集成测试
mvn test -Dtest=*IntegrationTest

# 或者使用脚本
chmod +x run-integration-tests.sh
./run-integration-tests.sh
```

### 步骤3: 查看结果

测试完成后会显示类似输出：
```
Tests run: 47, Failures: 0, Errors: 0, Skipped: 0
[INFO] BUILD SUCCESS
```

---

## 📋 测试内容概览

### 1. 管理员功能测试（15个用例）
- ✅ 权限校验和身份切换
- ✅ 仪表盘数据聚合
- ✅ 用户管理（CRUD + 踢出）
- ✅ 运动员档案导入导出

### 2. 训练统计分析测试（17个用例）
- ✅ 多维度统计（时间/运动员/项目）
- ✅ 数据导出（Excel）
- ✅ 参数规范化
- ✅ 边界场景处理

### 3. 比赛管理测试（15个用例）
- ✅ 比赛配置和权限控制
- ✅ 报名管理和时间窗口
- ✅ 强制结束机制
- ✅ 成绩导出（CSV/Excel/PDF）

---

## 🔍 单独运行特定测试

```bash
# 只测试管理员功能
mvn test -Dtest=AdminControllerIntegrationTest

# 只测试训练分析
mvn test -Dtest=TrainingAnalyticsServiceIntegrationTest

# 只测试比赛管理
mvn test -Dtest=CompetitionServiceIntegrationTest

# 运行特定测试方法
mvn test -Dtest=AdminControllerIntegrationTest#testAdminAccessDashboard_Success
```

---

## ❓ 常见问题

### Q1: 测试失败提示 "Unknown column"
**A**: 数据库表结构未更新，重新运行 `schema.sql`

### Q2: 测试失败提示 "Connection refused"
**A**: MySQL 未启动，执行 `brew services start mysql` 或启动 MySQL 服务

### Q3: 测试很慢
**A**: 正常现象，集成测试需要启动 Spring Boot 容器，首次运行约15-20秒

### Q4: 某些测试偶尔失败
**A**: 可能是并发问题，使用 `@Order` 注解已经控制了执行顺序，重新运行通常可以解决

---

## 📊 测试报告位置

```
test-reports/
├── all-tests.log           # 完整测试日志
└── surefire-reports/       # Maven 测试报告
    ├── TEST-AdminControllerIntegrationTest.xml
    ├── TEST-TrainingAnalyticsServiceIntegrationTest.xml
    └── TEST-CompetitionServiceIntegrationTest.xml
```

---

## 📚 更多文档

- [集成测试指南](./集成测试指南.md) - 详细的测试说明和场景表格
- [集成测试实施报告](./集成测试实施报告.md) - 完整的实施情况报告
- [全功能测试指南](./全功能测试指南-Cursor-MCP.md) - 手动测试指南

---

## 🎯 核心价值

本集成测试套件实现了：

1. **✅ 自动化验证**: 47个测试用例自动验证核心功能
2. **✅ 持续集成**: 可集成到 CI/CD 流程
3. **✅ 回归测试**: 防止新代码破坏已有功能
4. **✅ 文档化**: 测试即文档，展示API使用方式

---

**最后更新**: 2025-10-17


