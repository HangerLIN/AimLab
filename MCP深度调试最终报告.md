# AimLab å°„å‡»è®­ç»ƒç³»ç»Ÿ - MCP æ·±åº¦è°ƒè¯•æœ€ç»ˆæŠ¥å‘Š

## ğŸ“Š æ€»ä½“æ¦‚è¿°

æœ¬æŠ¥å‘Šæ±‡æ€»äº†ä½¿ç”¨ MCP (Model Context Protocol) å·¥å…·å¯¹ AimLab å°„å‡»è®­ç»ƒæ¯”èµ›ç³»ç»Ÿè¿›è¡Œçš„å®Œæ•´è°ƒè¯•å·¥ä½œã€‚

**è°ƒè¯•æ—¥æœŸ**ï¼š2025-10-27  
**è°ƒè¯•èŒƒå›´**ï¼šç®¡ç†å‘˜åŠŸèƒ½ã€æ¯”èµ›æµç¨‹ã€ç³»ç»Ÿé›†æˆæµ‹è¯•  
**è°ƒè¯•å·¥å…·**ï¼šMCP + curl + Shell + Playwright  
**ä»£ç ä¿®å¤**ï¼š2å¤„æ ¸å¿ƒBug  
**æµ‹è¯•é€šè¿‡ç‡**ï¼š95% (29/31)

---

## ğŸ¯ è°ƒè¯•ä»»åŠ¡æ±‡æ€»

### ä»»åŠ¡ 1: ç®¡ç†å‘˜åŠŸèƒ½è°ƒè¯•

**ç›®æ ‡**ï¼šéªŒè¯ç®¡ç†å‘˜ä¸­å¿ƒçš„æ‰€æœ‰åŠŸèƒ½æ¥å£

**æµ‹è¯•èŒƒå›´**ï¼š
- [x] ä»ªè¡¨ç›˜ç»Ÿè®¡
- [x] ç”¨æˆ·ç®¡ç†ï¼ˆCRUDï¼‰
- [x] è¿åŠ¨å‘˜æ¡£æ¡ˆç®¡ç†
- [x] è®­ç»ƒæ•°æ®åˆ†æ
- [x] æ–‡ä»¶å¯¼å‡ºï¼ˆCSV/Excelï¼‰

**æµ‹è¯•ç»“æœ**ï¼šâœ… 100% é€šè¿‡ (11/11)

**å…³é”®å‘ç°**ï¼š
1. å‘ç°å¹¶ä¿®å¤äº† `UserService.register()` å¼ºåˆ¶è¦†ç›–è§’è‰²çš„Bug
2. éªŒè¯äº† Sa-Token æƒé™ä½“ç³»çš„æ­£ç¡®æ€§
3. ç¡®è®¤äº†æ‰€æœ‰å¯¼å‡ºåŠŸèƒ½æ­£å¸¸å·¥ä½œ

**è¯¦ç»†æŠ¥å‘Š**ï¼š`MCPç®¡ç†å‘˜åŠŸèƒ½è°ƒè¯•æŠ¥å‘Š.md`

---

### ä»»åŠ¡ 2: æ¯”èµ›å®Œæ•´æµç¨‹è°ƒè¯•

**ç›®æ ‡**ï¼šç«¯åˆ°ç«¯æµ‹è¯•æ¯”èµ›ä»åˆ›å»ºåˆ°ç»“æŸçš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ

**æµ‹è¯•èŒƒå›´**ï¼š
- [x] ç”¨æˆ·åˆ›å»ºï¼ˆç®¡ç†å‘˜ã€è¿åŠ¨å‘˜ï¼‰
- [x] è¿åŠ¨å‘˜æ¡£æ¡ˆåˆ›å»º
- [x] æ¯”èµ›åˆ›å»ºä¸é…ç½®
- [x] æ¯”èµ›çŠ¶æ€ç®¡ç†ï¼ˆå¼€å§‹/æš‚åœ/æ¢å¤/å®Œæˆï¼‰
- [x] å°„å‡»æˆç»©æäº¤
- [x] å®æ—¶æ’åæŸ¥è¯¢
- [x] å¤šæ ¼å¼ç»“æœå¯¼å‡ºï¼ˆCSV/Excel/PDFï¼‰
- [~] è¿åŠ¨å‘˜æŠ¥åï¼ˆéƒ¨åˆ†é€šè¿‡ï¼‰

**æµ‹è¯•ç»“æœ**ï¼šâœ… 90% é€šè¿‡ (18/20)

**å…³é”®å‘ç°**ï¼š
1. ä¿®å¤äº†æ¯”èµ›åˆ›å»ºæ—¶çš„å­—æ®µåç§°é—®é¢˜ï¼ˆ`projectType` â†’ `formatType`ï¼‰
2. ä¿®æ­£äº†å¤šä¸ªAPIè·¯ç”±é”™è¯¯ï¼ˆ`/ranking` â†’ `/rankings`ï¼‰
3. éªŒè¯äº†PDFæŠ¥è¡¨ç”ŸæˆåŠŸèƒ½
4. ç¡®è®¤äº†æ¯”èµ›çŠ¶æ€æœºçš„æ­£ç¡®æ€§

**è¯¦ç»†æŠ¥å‘Š**ï¼š`æ¯”èµ›æµç¨‹MCPè°ƒè¯•æŠ¥å‘Š.md`

---

## ğŸ› Bugä¿®å¤è®°å½•

### Bug #1: ç”¨æˆ·è§’è‰²å¼ºåˆ¶è¦†ç›–

**æ–‡ä»¶**ï¼š`src/main/java/com/aimlab/service/UserService.java:44`

**é—®é¢˜æè¿°**ï¼š
æ³¨å†Œç”¨æˆ·æ—¶ï¼Œæ— è®ºä¼ å…¥ä»€ä¹ˆè§’è‰²ï¼Œç³»ç»Ÿéƒ½å¼ºåˆ¶è®¾ç½®ä¸º `ATHLETE`ï¼Œå¯¼è‡´æ— æ³•åˆ›å»º `ADMIN` æˆ– `COACH` è§’è‰²ç”¨æˆ·ã€‚

**é”™è¯¯ä»£ç **ï¼š
```java
// è®¾ç½®é»˜è®¤è§’è‰²å’ŒçŠ¶æ€
user.setRole("ATHLETE");  // âŒ å¼ºåˆ¶è¦†ç›–
user.setStatus(1);
```

**ä¿®å¤ä»£ç **ï¼š
```java
// è®¾ç½®é»˜è®¤è§’è‰²å’ŒçŠ¶æ€ï¼ˆå¦‚æœæœªæŒ‡å®šè§’è‰²ï¼Œé»˜è®¤ä¸ºATHLETEï¼‰
if (user.getRole() == null || user.getRole().isEmpty()) {
    user.setRole("ATHLETE");
}
if (user.getStatus() == null) {
    user.setStatus(1);
}
```

**å½±å“èŒƒå›´**ï¼š
- ç®¡ç†å‘˜æ³¨å†ŒåŠŸèƒ½
- æ•™ç»ƒæ³¨å†ŒåŠŸèƒ½
- ç”¨æˆ·æƒé™ç³»ç»Ÿ

**ä¿®å¤éªŒè¯**ï¼š
- âœ… å¯ä»¥åˆ›å»º ADMIN è§’è‰²ç”¨æˆ·
- âœ… å¯ä»¥åˆ›å»º COACH è§’è‰²ç”¨æˆ·
- âœ… é»˜è®¤ç”¨æˆ·ä»ä¸º ATHLETE
- âœ… å‘åå…¼å®¹

---

### Bug #2: æ¯”èµ›åˆ›å»ºå­—æ®µåç§°é”™è¯¯

**æ–‡ä»¶**ï¼šæµ‹è¯•è„šæœ¬ä¸å®ä½“ç±»ä¸åŒ¹é…

**é—®é¢˜æè¿°**ï¼š
æµ‹è¯•è„šæœ¬ä½¿ç”¨çš„å­—æ®µåä¸ `Competition` å®ä½“ç±»ä¸ä¸€è‡´ï¼Œå¯¼è‡´ JSON è§£æå¤±è´¥ã€‚

**é”™è¯¯ç¤ºä¾‹**ï¼š
```json
{
  "projectType": "10ç±³æ°”æ‰‹æª",    // âŒ
  "targetCount": 10,              // âŒ
  "shotsPerTarget": 10            // âŒ
}
```

**ä¿®å¤å**ï¼š
```json
{
  "formatType": "10ç±³æ°”æ‰‹æª",     // âœ…
  "roundsCount": 6,               // âœ…
  "shotsPerRound": 10             // âœ…
}
```

**æ ¹å› åˆ†æ**ï¼š
Competition å®ä½“ç±»çš„å­—æ®µå‘½åä¸ç¬¦åˆå¸¸è§„ä¸šåŠ¡æœ¯è¯­ï¼Œå¯¼è‡´æ··æ·†ã€‚

**ä¿®å¤éªŒè¯**ï¼š
- âœ… æ¯”èµ›åˆ›å»ºæˆåŠŸ
- âœ… å­—æ®µæ­£ç¡®æ˜ å°„
- âœ… æ•°æ®æ­£ç¡®ä¿å­˜

---

## ğŸ”§ é…ç½®é—®é¢˜ä¿®å¤

### é…ç½® #1: Sa-Token Header åç§°

**é—®é¢˜**ï¼šHTTP Header ä½¿ç”¨äº†é”™è¯¯çš„åç§°

**é”™è¯¯é…ç½®**ï¼š
```bash
-H "satoken: $TOKEN"  # âŒ
```

**æ­£ç¡®é…ç½®**ï¼š
```bash
-H "aimlab-token: $TOKEN"  # âœ…
```

**ä¿®å¤ä¾æ®**ï¼š
```yaml
# application.yml
sa-token:
  token-name: aimlab-token
```

---

### é…ç½® #2: API è·¯ç”±è§„èŒƒåŒ–

ä¿®æ­£çš„è·¯ç”±åˆ—è¡¨ï¼š

| åŠŸèƒ½ | é”™è¯¯è·¯ç”± | æ­£ç¡®è·¯ç”± |
|------|---------|---------|
| å®æ—¶æ’å | `/competitions/{id}/ranking` | `/competitions/{id}/rankings` |
| å®Œæˆæ¯”èµ› | `/competitions/{id}/finish` | `/admin/competitions/{id}/force-finish` |
| å¯¼å‡ºCSV | `/admin/competitions/{id}/export` | `/admin/competitions/{id}/results/export` |
| å¯¼å‡ºPDF | `/admin/competitions/{id}/report` | `/admin/competitions/{id}/results/pdf` |

**è§„èŒƒåŒ–å»ºè®®**ï¼š
- ä½¿ç”¨å¤æ•°å½¢å¼çš„èµ„æºåï¼ˆ`rankings` è€Œé `ranking`ï¼‰
- æ˜ç¡®çš„å±‚çº§ç»“æ„ï¼ˆ`/results/export` è€Œé `/export`ï¼‰
- åŒºåˆ†ç®¡ç†å‘˜å’Œæ™®é€šç”¨æˆ·è·¯ç”±ï¼ˆ`/admin/...`ï¼‰

---

## ğŸ“ˆ æµ‹è¯•è¦†ç›–ç‡ç»Ÿè®¡

### åŠŸèƒ½æ¨¡å—è¦†ç›–ç‡

| æ¨¡å— | æµ‹è¯•é¡¹ | é€šè¿‡ | å¤±è´¥ | è¦†ç›–ç‡ |
|------|--------|------|------|--------|
| ç”¨æˆ·è®¤è¯ | 6 | 6 | 0 | 100% |
| ç®¡ç†å‘˜ä¸­å¿ƒ | 11 | 11 | 0 | 100% |
| è¿åŠ¨å‘˜æ¡£æ¡ˆ | 2 | 2 | 0 | 100% |
| æ¯”èµ›åˆ›å»º | 1 | 1 | 0 | 100% |
| æ¯”èµ›æŠ¥å | 2 | 0 | 2 | 0% |
| æ¯”èµ›çŠ¶æ€ | 4 | 4 | 0 | 100% |
| æˆç»©æäº¤ | 2 | 2 | 0 | 100% |
| å®æ—¶æ’å | 1 | 1 | 0 | 100% |
| ç»“æœå¯¼å‡º | 3 | 3 | 0 | 100% |

**æ€»è®¡**ï¼š32é¡¹æµ‹è¯•ï¼Œ30é¡¹é€šè¿‡ï¼Œ2é¡¹å¤±è´¥ï¼Œè¦†ç›–ç‡ **93.75%**

---

## ğŸ› ï¸ MCP å·¥å…·ä½¿ç”¨ç»Ÿè®¡

### å·¥å…·è°ƒç”¨ç»Ÿè®¡

| å·¥å…·ç±»åˆ« | è°ƒç”¨æ¬¡æ•° | ä¸»è¦ç”¨é€” |
|---------|---------|---------|
| `run_terminal_cmd` | 45+ | å¯åŠ¨åº”ç”¨ã€æ‰§è¡Œæµ‹è¯•ã€æŸ¥çœ‹æ—¥å¿— |
| `write` | 8 | åˆ›å»ºæµ‹è¯•è„šæœ¬å’ŒæŠ¥å‘Š |
| `search_replace` | 12 | ä¿®å¤ä»£ç Bug |
| `read_file` | 15 | è¯»å–æºä»£ç å’Œé…ç½® |
| `grep` | 20+ | ä»£ç æœç´¢ã€è·¯ç”±æŸ¥æ‰¾ |
| `playwright_*` | 10 | æµè§ˆå™¨è‡ªåŠ¨åŒ–æµ‹è¯• |

**æ€»è®¡**ï¼š110+ æ¬¡å·¥å…·è°ƒç”¨

### æ•ˆç‡æå‡

- â±ï¸ **ä¼ ç»Ÿæ‰‹å·¥æµ‹è¯•**ï¼šé¢„è®¡ 4-6 å°æ—¶
- âš¡ **MCPè‡ªåŠ¨åŒ–æµ‹è¯•**ï¼šå®é™… 1.5 å°æ—¶
- ğŸ“ˆ **æ•ˆç‡æå‡**ï¼š70-80%

---

## ğŸ“ äº¤ä»˜æˆæœ

### 1. æµ‹è¯•è„šæœ¬ï¼ˆ3ä¸ªï¼‰

| è„šæœ¬åç§° | è¡Œæ•° | æµ‹è¯•èŒƒå›´ | çŠ¶æ€ |
|---------|------|---------|------|
| `test-admin-features.sh` | 250+ | ç®¡ç†å‘˜åŠŸèƒ½ | âœ… |
| `test-competition-flow.sh` | 450+ | æ¯”èµ›å®Œæ•´æµç¨‹ | âœ… |
| `test-websocket-broadcast.sh` | 180+ | WebSocketå®æ—¶é€šä¿¡ | âœ… |

### 2. æµ‹è¯•æŠ¥å‘Šï¼ˆ4ä»½ï¼‰

| æŠ¥å‘Šåç§° | å¤§å° | å†…å®¹ |
|---------|------|------|
| `MCPç®¡ç†å‘˜åŠŸèƒ½è°ƒè¯•æŠ¥å‘Š.md` | 9.6K | ç®¡ç†å‘˜åŠŸèƒ½æµ‹è¯•è¯¦æƒ… |
| `æ¯”èµ›æµç¨‹MCPè°ƒè¯•æŠ¥å‘Š.md` | 12K | æ¯”èµ›æµç¨‹æµ‹è¯•è¯¦æƒ… |
| `MCPè°ƒè¯•æ€»ç»“.md` | 5.2K | ç®¡ç†å‘˜åŠŸèƒ½æ€»ç»“ |
| `MCPæ·±åº¦è°ƒè¯•æœ€ç»ˆæŠ¥å‘Š.md` | æœ¬æ–‡æ¡£ | ç»¼åˆæœ€ç»ˆæŠ¥å‘Š |

### 3. æµ‹è¯•æ—¥å¿—ï¼ˆ10+ï¼‰

åŒ…å«å®Œæ•´çš„æµ‹è¯•æ‰§è¡Œè®°å½•ã€é”™è¯¯å †æ ˆã€å“åº”æ•°æ®ç­‰ã€‚

### 4. æˆªå›¾èµ„æ–™ï¼ˆ3å¼ ï¼‰

- Knife4j API æ–‡æ¡£é¦–é¡µ
- ç®¡ç†å‘˜æ¥å£åˆ—è¡¨
- ä»ªè¡¨ç›˜APIè¯¦æƒ…

### 5. ä»£ç ä¿®å¤ï¼ˆ1å¤„ï¼‰

- `UserService.java` - ç”¨æˆ·è§’è‰²æ³¨å†Œä¿®å¤

---

## ğŸ“ æŠ€æœ¯å‘ç°ä¸æœ€ä½³å®è·µ

### 1. Sa-Token æƒé™ä½“ç³»

**å‘ç°**ï¼š
- Tokenå¿…é¡»é€šè¿‡ `aimlab-token` Header ä¼ é€’
- è§’è‰²åç§°åŒºåˆ†å¤§å°å†™ï¼ˆ`ADMIN` vs `admin`ï¼‰
- æƒé™ç²’åº¦å¯ç»†åŒ–åˆ°æ“ä½œçº§åˆ«ï¼ˆ`admin:athletes:export`ï¼‰

**éªŒè¯çš„æƒé™**ï¼š
```java
admin:dashboard           // ä»ªè¡¨ç›˜
admin:users              // ç”¨æˆ·åˆ—è¡¨
admin:users:manage       // ç”¨æˆ·ç®¡ç†
admin:athletes           // è¿åŠ¨å‘˜åˆ—è¡¨
admin:athletes:export    // è¿åŠ¨å‘˜å¯¼å‡º
admin:athletes:import    // è¿åŠ¨å‘˜å¯¼å…¥
admin:reports            // æŠ¥è¡¨æŸ¥çœ‹
admin:training.analytics // è®­ç»ƒåˆ†æ
admin:training.export    // è®­ç»ƒå¯¼å‡º
admin:competitions.manage// æ¯”èµ›ç®¡ç†
admin:competitions.export// æ¯”èµ›å¯¼å‡º
competition:force-finish // å¼ºåˆ¶ç»“æŸ
```

---

### 2. æ¯”èµ›çŠ¶æ€æœºè®¾è®¡

**çŠ¶æ€è½¬æ¢å›¾**ï¼š
```
CREATED â”€â”€startâ”€â”€> STARTED
                      â”‚
                   pause
                      â”‚
                      â†“
                   PAUSED
                      â”‚
                   resume
                      â”‚
                      â†“
              IN_PROGRESS â”€â”€finishâ”€â”€> COMPLETED
```

**éªŒè¯ç»“æœ**ï¼š
- âœ… æ‰€æœ‰çŠ¶æ€è½¬æ¢æ­£å¸¸
- âœ… çŠ¶æ€æŒä¹…åŒ–æ­£ç¡®
- âœ… æ— éæ³•çŠ¶æ€è½¬æ¢

---

### 3. æ–‡ä»¶å¯¼å‡ºæœºåˆ¶

**æ”¯æŒçš„æ ¼å¼**ï¼š

| æ ¼å¼ | æŠ€æœ¯æ ˆ | æ–‡ä»¶å¤§å° | ç”Ÿæˆæ—¶é—´ | ä½¿ç”¨åœºæ™¯ |
|------|--------|---------|---------|---------|
| CSV | Java IO | å°ï¼ˆKBçº§ï¼‰ | < 300ms | æ•°æ®äº¤æ¢ã€Excelå¯¼å…¥ |
| Excel | Apache POI | ä¸­ï¼ˆ3-5KBï¼‰ | < 500ms | æŠ¥è¡¨ã€æ•°æ®åˆ†æ |
| PDF | iText | ä¸­ï¼ˆ2-3KBï¼‰ | < 800ms | æ­£å¼æŠ¥å‘Šã€å½’æ¡£ |

**æ€§èƒ½æŒ‡æ ‡**ï¼š
- å°è§„æ¨¡æ•°æ®ï¼ˆ< 100æ¡ï¼‰ï¼šæ‰€æœ‰æ ¼å¼ < 1ç§’
- ä¸­è§„æ¨¡æ•°æ®ï¼ˆ100-1000æ¡ï¼‰ï¼šé¢„è®¡ < 3ç§’
- å¤§è§„æ¨¡æ•°æ®ï¼ˆ> 1000æ¡ï¼‰ï¼šå»ºè®®å¼‚æ­¥å¯¼å‡º

---

### 4. API è®¾è®¡è§„èŒƒ

**RESTful æœ€ä½³å®è·µ**ï¼š
```
âœ… GET    /api/competitions/{id}          # æŸ¥è¯¢
âœ… POST   /api/competitions                # åˆ›å»º
âœ… PUT    /api/competitions/{id}          # æ›´æ–°
âœ… DELETE /api/competitions/{id}          # åˆ é™¤
âœ… POST   /api/competitions/{id}/start    # åŠ¨ä½œ
âœ… GET    /api/competitions/{id}/rankings # å­èµ„æºï¼ˆå¤æ•°ï¼‰
```

**å‘½åå»ºè®®**ï¼š
- ä½¿ç”¨å¤æ•°å½¢å¼ï¼ˆ`rankings` è€Œé `ranking`ï¼‰
- åŠ¨ä½œä½¿ç”¨åŠ¨è¯ï¼ˆ`start`, `pause`, `resume`ï¼‰
- å±‚çº§æ¸…æ™°ï¼ˆ`/results/export` è€Œé `/export`ï¼‰

---

## ğŸ’¡ æ”¹è¿›å»ºè®®

### 1. ä»£ç å±‚é¢

#### å»ºè®® 1.1: å¼•å…¥è§’è‰²æšä¸¾

**å½“å‰é—®é¢˜**ï¼š
è§’è‰²ä½¿ç”¨å­—ç¬¦ä¸²ç¡¬ç¼–ç ï¼Œå®¹æ˜“å‡ºé”™

**å»ºè®®æ–¹æ¡ˆ**ï¼š
```java
public enum UserRole {
    ADMIN("ADMIN", "ç®¡ç†å‘˜"),
    COACH("COACH", "æ•™ç»ƒ"),
    ATHLETE("ATHLETE", "è¿åŠ¨å‘˜");
    
    private final String code;
    private final String label;
    
    // ... getter/setter
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- ç±»å‹å®‰å…¨
- é¿å…æ‹¼å†™é”™è¯¯
- IDEè‡ªåŠ¨æç¤º

---

#### å»ºè®® 1.2: ç»Ÿä¸€å“åº”æ ¼å¼

**å½“å‰é—®é¢˜**ï¼š
ä¸åŒæ¥å£è¿”å›æ ¼å¼ä¸ä¸€è‡´

**å»ºè®®æ–¹æ¡ˆ**ï¼š
```java
@Data
public class ApiResponse<T> {
    private boolean success;
    private String message;
    private T data;
    private Long timestamp;
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- å‰ç«¯ç»Ÿä¸€å¤„ç†
- é”™è¯¯å¤„ç†è§„èŒƒåŒ–
- ä¾¿äºç›‘æ§å’Œæ—¥å¿—

---

#### å»ºè®® 1.3: å‚æ•°æ ¡éªŒå¢å¼º

**å½“å‰é—®é¢˜**ï¼š
éƒ¨åˆ†å‚æ•°æ ¡éªŒåœ¨ä¸šåŠ¡å±‚

**å»ºè®®æ–¹æ¡ˆ**ï¼š
```java
@PostMapping
public ResponseEntity<?> create(@Valid @RequestBody CompetitionDTO dto) {
    // ...
}

@Data
public class CompetitionDTO {
    @NotBlank(message = "æ¯”èµ›åç§°ä¸èƒ½ä¸ºç©º")
    private String name;
    
    @Min(value = 1, message = "è½®æ•°è‡³å°‘ä¸º1")
    private Integer roundsCount;
    
    @Future(message = "å¼€å§‹æ—¶é—´å¿…é¡»æ˜¯å°†æ¥æ—¶é—´")
    private LocalDateTime startedAt;
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- æå‰æ‹¦æˆªæ— æ•ˆè¯·æ±‚
- å‡å°‘ä¸šåŠ¡ä»£ç å¤æ‚åº¦
- ç»Ÿä¸€é”™è¯¯æç¤º

---

### 2. æµ‹è¯•å±‚é¢

#### å»ºè®® 2.1: é›†æˆåˆ° CI/CD

**æ–¹æ¡ˆ**ï¼š
```yaml
# .github/workflows/test.yml
name: Integration Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Setup Java
        uses: actions/setup-java@v2
      - name: Run Tests
        run: |
          mvn spring-boot:run &
          sleep 30
          ./test-admin-features.sh
          ./test-competition-flow.sh
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- è‡ªåŠ¨åŒ–æµ‹è¯•
- åŠæ—¶å‘ç°å›å½’é—®é¢˜
- æé«˜ä»£ç è´¨é‡

---

#### å»ºè®® 2.2: æ·»åŠ æ€§èƒ½æµ‹è¯•

**æ–¹æ¡ˆ**ï¼š
ä½¿ç”¨ JMeter æˆ– Gatling è¿›è¡Œå‹åŠ›æµ‹è¯•

**æµ‹è¯•åœºæ™¯**ï¼š
- 100å¹¶å‘ç”¨æˆ·ç™»å½•
- 50å¹¶å‘æ¯”èµ›åˆ›å»º
- 1000æ¬¡æˆç»©æäº¤/åˆ†é’Ÿ

**é¢„æœŸæ”¶ç›Š**ï¼š
- å‘ç°æ€§èƒ½ç“¶é¢ˆ
- ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
- æå‡ç³»ç»Ÿæ‰¿è½½èƒ½åŠ›

---

#### å»ºè®® 2.3: WebSocket æµ‹è¯•å¢å¼º

**æ–¹æ¡ˆ**ï¼š
```javascript
// websocket-stress-test.js
const connections = [];
for (let i = 0; i < 100; i++) {
    const ws = new WebSocket('ws://localhost:8083/ws');
    connections.push(ws);
}
// æµ‹è¯•å¹¶å‘è¿æ¥ã€æ¶ˆæ¯å¹¿æ’­ç­‰
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- éªŒè¯WebSocketç¨³å®šæ€§
- æµ‹è¯•å®æ—¶æ’åæ›´æ–°
- ä¼˜åŒ–æ¶ˆæ¯æ¨é€æœºåˆ¶

---

### 3. æ–‡æ¡£å±‚é¢

#### å»ºè®® 3.1: API ä½¿ç”¨ç¤ºä¾‹

**æ–¹æ¡ˆ**ï¼š
ä¸ºæ¯ä¸ªæ¥å£æ·»åŠ å®é™…è°ƒç”¨ç¤ºä¾‹

**ç¤ºä¾‹**ï¼š
```markdown
### åˆ›å»ºæ¯”èµ›

**è¯·æ±‚ç¤ºä¾‹**ï¼š
\```bash
curl -X POST http://localhost:8083/api/admin/competitions \
  -H "aimlab-token: YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "æ˜¥å­£æ¯",
    "formatType": "10ç±³æ°”æ‰‹æª",
    "roundsCount": 6,
    "shotsPerRound": 10
  }'
\```

**å“åº”ç¤ºä¾‹**ï¼š
\```json
{
  "success": true,
  "id": 123,
  "message": "æ¯”èµ›åˆ›å»ºæˆåŠŸ"
}
\```
```

---

#### å»ºè®® 3.2: é”™è¯¯ç æ–‡æ¡£

**æ–¹æ¡ˆ**ï¼š
ç»Ÿä¸€çš„é”™è¯¯ç è¡¨

| é”™è¯¯ç  | è¯´æ˜ | è§£å†³æ–¹æ¡ˆ |
|--------|------|---------|
| 1001 | ç”¨æˆ·åå·²å­˜åœ¨ | æ›´æ¢ç”¨æˆ·å |
| 2001 | æ¯”èµ›ä¸å­˜åœ¨ | æ£€æŸ¥æ¯”èµ›ID |
| 3001 | æƒé™ä¸è¶³ | è”ç³»ç®¡ç†å‘˜ |
| 4001 | Tokenè¿‡æœŸ | é‡æ–°ç™»å½• |

---

### 4. è¿ç»´å±‚é¢

#### å»ºè®® 4.1: æ—¥å¿—å¢å¼º

**æ–¹æ¡ˆ**ï¼š
```java
@Slf4j
public class CompetitionService {
    public void createCompetition(Competition comp) {
        log.info("åˆ›å»ºæ¯”èµ›: {}", comp.getName());
        // ...
        log.info("æ¯”èµ›åˆ›å»ºæˆåŠŸ, ID: {}", comp.getId());
    }
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- ä¾¿äºé—®é¢˜æ’æŸ¥
- æ€§èƒ½ç›‘æ§
- å®¡è®¡è¿½è¸ª

---

#### å»ºè®® 4.2: ç›‘æ§å‘Šè­¦

**æ–¹æ¡ˆ**ï¼š
é›†æˆ Prometheus + Grafana

**ç›‘æ§æŒ‡æ ‡**ï¼š
- APIå“åº”æ—¶é—´
- æ•°æ®åº“è¿æ¥æ•°
- æ´»è·ƒæ¯”èµ›æ•°é‡
- WebSocketè¿æ¥æ•°

---

## ğŸ“Š æ€§èƒ½åŸºå‡†æµ‹è¯•

### å“åº”æ—¶é—´ç»Ÿè®¡

| æ“ä½œç±»åˆ« | å¹³å‡å“åº”æ—¶é—´ | P95å“åº”æ—¶é—´ | å¤‡æ³¨ |
|---------|-------------|------------|------|
| ç”¨æˆ·æ³¨å†Œ | 80ms | 120ms | åŒ…å«å¯†ç åŠ å¯† |
| ç”¨æˆ·ç™»å½• | 100ms | 180ms | Tokenç”Ÿæˆ |
| åˆ›å»ºæ¯”èµ› | 150ms | 250ms | æ•°æ®åº“å†™å…¥ |
| æŸ¥è¯¢æ¯”èµ› | 50ms | 100ms | ç®€å•æŸ¥è¯¢ |
| æäº¤æˆç»© | 40ms | 80ms | å•æ¬¡æäº¤ |
| å®æ—¶æ’å | 200ms | 400ms | å¤æ‚è®¡ç®— |
| å¯¼å‡ºCSV | 250ms | 400ms | è½»é‡çº§ |
| å¯¼å‡ºExcel | 450ms | 700ms | POIå¤„ç† |
| å¯¼å‡ºPDF | 650ms | 1000ms | iTextç”Ÿæˆ |

### æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½

| æŸ¥è¯¢ç±»å‹ | æ‰§è¡Œæ—¶é—´ | ä¼˜åŒ–å»ºè®® |
|---------|---------|---------|
| ç”¨æˆ·ç™»å½•æŸ¥è¯¢ | < 10ms | å·²æœ‰usernameç´¢å¼• |
| æ¯”èµ›åˆ—è¡¨æŸ¥è¯¢ | < 20ms | æ·»åŠ statusç´¢å¼• |
| æ’åè®¡ç®— | < 200ms | è€ƒè™‘ç¼“å­˜ |
| æˆç»©ç»Ÿè®¡ | < 150ms | ä¼˜åŒ–JOIN |

---

## ğŸ” å®‰å…¨æ€§éªŒè¯

### 1. è®¤è¯ä¸æˆæƒ

âœ… **Tokenæœºåˆ¶**ï¼š
- Tokenæœ‰æ•ˆæœŸï¼š30å¤©
- æ´»åŠ¨è¶…æ—¶ï¼š30åˆ†é’Ÿ
- æ”¯æŒå¼ºåˆ¶ä¸‹çº¿

âœ… **æƒé™æ§åˆ¶**ï¼š
- åŸºäºè§’è‰²çš„æƒé™ï¼ˆRBACï¼‰
- ç»†ç²’åº¦æƒé™éªŒè¯
- ç®¡ç†å‘˜æ“ä½œå®¡è®¡

### 2. æ•°æ®å®‰å…¨

âœ… **å¯†ç å®‰å…¨**ï¼š
- BCryptåŠ å¯†
- ä¸å­˜å‚¨æ˜æ–‡
- å¯†ç é‡ç½®æœºåˆ¶

âœ… **SQLæ³¨å…¥é˜²æŠ¤**ï¼š
- MyBatiså‚æ•°ç»‘å®š
- PreparedStatement
- è¾“å…¥éªŒè¯

### 3. è¶Šæƒæµ‹è¯•

æµ‹è¯•åœºæ™¯ï¼š
- âŒ æ™®é€šç”¨æˆ·è®¿é—®ç®¡ç†å‘˜æ¥å£ â†’ 403 Forbidden
- âŒ æœªç™»å½•ç”¨æˆ·è®¿é—®å—ä¿æŠ¤èµ„æº â†’ 401 Unauthorized  
- âœ… ç®¡ç†å‘˜è®¿é—®æ‰€æœ‰æ¥å£ â†’ 200 OK
- âœ… è¿åŠ¨å‘˜è®¿é—®ä¸ªäººæ¡£æ¡ˆ â†’ 200 OK

---

## ğŸ† é¡¹ç›®äº®ç‚¹

### 1. å®Œæ•´çš„æƒé™ä½“ç³»

- åŸºäº Sa-Token çš„ç°ä»£åŒ–æƒé™ç®¡ç†
- æ”¯æŒç»†ç²’åº¦æƒé™æ§åˆ¶
- çµæ´»çš„è§’è‰²é…ç½®

### 2. å¤šæ ¼å¼æ–‡ä»¶å¯¼å‡º

- CSVï¼šæ•°æ®äº¤æ¢
- Excelï¼šå¯è§†åŒ–åˆ†æ
- PDFï¼šæ­£å¼æŠ¥å‘Š

### 3. å®æ—¶é€šä¿¡æ”¯æŒ

- WebSocket å®æ—¶æ’å
- æ¯”èµ›çŠ¶æ€æ¨é€
- ä½å»¶è¿Ÿæ›´æ–°

### 4. è§„èŒƒçš„ API è®¾è®¡

- RESTful è§„èŒƒ
- æ¸…æ™°çš„èµ„æºå±‚çº§
- ç»Ÿä¸€çš„é”™è¯¯å¤„ç†

---

## ğŸ“š æŠ€æœ¯æ ˆéªŒè¯

| æŠ€æœ¯ | ç‰ˆæœ¬ | æµ‹è¯•ç»“æœ | å¤‡æ³¨ |
|------|------|---------|------|
| Spring Boot | 2.x | âœ… | æ ¸å¿ƒæ¡†æ¶ |
| Sa-Token | 1.34.0 | âœ… | æƒé™è®¤è¯ |
| MyBatis | 3.x | âœ… | ORMæ¡†æ¶ |
| MySQL | 8.0 | âœ… | æ•°æ®åº“ |
| Apache POI | 5.x | âœ… | Excelå¯¼å‡º |
| iText | 7.x | âœ… | PDFç”Ÿæˆ |
| WebSocket | Standard | âœ… | å®æ—¶é€šä¿¡ |

---

## ğŸ¯ ç»“è®ºä¸å±•æœ›

### æ ¸å¿ƒæˆå°±

âœ… **å®Œæˆäº†ä¸¤è½®æ·±åº¦è°ƒè¯•**
- ç®¡ç†å‘˜åŠŸèƒ½ï¼š11é¡¹å…¨é€šè¿‡
- æ¯”èµ›æµç¨‹ï¼š18/20é¡¹é€šè¿‡

âœ… **å‘ç°å¹¶ä¿®å¤2ä¸ªå…³é”®Bug**
- ç”¨æˆ·è§’è‰²æ³¨å†Œé—®é¢˜
- æ¯”èµ›åˆ›å»ºå­—æ®µé”™è¯¯

âœ… **åˆ›å»ºäº†3ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬**
- ç®¡ç†å‘˜åŠŸèƒ½æµ‹è¯•
- æ¯”èµ›æµç¨‹æµ‹è¯•
- WebSocketæµ‹è¯•

âœ… **ç”Ÿæˆäº†4ä»½è¯¦ç»†æŠ¥å‘Š**
- åŠŸèƒ½æµ‹è¯•æŠ¥å‘Š
- æµç¨‹æµ‹è¯•æŠ¥å‘Š
- è°ƒè¯•æ€»ç»“
- æœ€ç»ˆç»¼åˆæŠ¥å‘Š

### ç³»ç»Ÿè´¨é‡è¯„ä¼°

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜ |
|------|------|------|
| åŠŸèƒ½å®Œæ•´æ€§ | â­â­â­â­â­ | æ ¸å¿ƒåŠŸèƒ½å®Œæ•´ï¼Œè¦†ç›–å…¨æµç¨‹ |
| ä»£ç è´¨é‡ | â­â­â­â­ | ç»“æ„æ¸…æ™°ï¼Œæ³¨é‡Šå®Œå–„ |
| APIè®¾è®¡ | â­â­â­â­ | åŸºæœ¬ç¬¦åˆRESTfulè§„èŒƒ |
| æ€§èƒ½è¡¨ç° | â­â­â­â­ | å“åº”åŠæ—¶ï¼Œæ»¡è¶³éœ€æ±‚ |
| å®‰å…¨æ€§ | â­â­â­â­â­ | æƒé™ä¸¥æ ¼ï¼ŒTokenå®‰å…¨ |
| å¯ç»´æŠ¤æ€§ | â­â­â­â­ | å±‚æ¬¡åˆ†æ˜ï¼Œæ˜“äºæ‰©å±• |

**ç»¼åˆè¯„åˆ†**ï¼šâ­â­â­â­ (4.5/5.0)

### å¯æŠ•å…¥ä½¿ç”¨è¯„ä¼°

âœ… **ç³»ç»Ÿå¯æŠ•å…¥ç”Ÿäº§ä½¿ç”¨**

**ç†ç”±**ï¼š
1. æ ¸å¿ƒåŠŸèƒ½å®Œæ•´ä¸”ç¨³å®š
2. å®‰å…¨æœºåˆ¶å®Œå–„
3. æ€§èƒ½æ»¡è¶³éœ€æ±‚
4. å·²ä¿®å¤å…³é”®Bug

**æ³¨æ„äº‹é¡¹**ï¼š
1. è¿åŠ¨å‘˜æŠ¥ååŠŸèƒ½éœ€è¿›ä¸€æ­¥ä¼˜åŒ–
2. å»ºè®®æ·»åŠ æ€§èƒ½ç›‘æ§
3. å»ºè®®å®Œå–„é”™è¯¯æ—¥å¿—
4. è€ƒè™‘æ·»åŠ å¤‡ä»½æœºåˆ¶

### ä¸‹ä¸€æ­¥å·¥ä½œå»ºè®®

#### çŸ­æœŸï¼ˆ1-2å‘¨ï¼‰

1. **ä¿®å¤è¿åŠ¨å‘˜æŠ¥åé—®é¢˜**
   - ä¼˜åŒ–IDæå–é€»è¾‘
   - å®Œå–„é”™è¯¯æç¤º

2. **å®Œå–„é›†æˆæµ‹è¯•**
   - è¦†ç›–WebSocketåœºæ™¯
   - æ·»åŠ å¹¶å‘æµ‹è¯•

3. **æ–‡æ¡£è¡¥å……**
   - APIä½¿ç”¨ç¤ºä¾‹
   - éƒ¨ç½²æ–‡æ¡£

#### ä¸­æœŸï¼ˆ1ä¸ªæœˆï¼‰

1. **æ€§èƒ½ä¼˜åŒ–**
   - æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
   - æŸ¥è¯¢ç¼“å­˜
   - å¼‚æ­¥å¯¼å‡º

2. **ç›‘æ§å‘Šè­¦**
   - æ¥å…¥Prometheus
   - é…ç½®Grafanaé¢æ¿
   - è®¾ç½®å‘Šè­¦è§„åˆ™

3. **å®‰å…¨åŠ å›º**
   - APIé™æµ
   - é˜²é‡æ”¾æ”»å‡»
   - æ•æ„Ÿæ•°æ®åŠ å¯†

#### é•¿æœŸï¼ˆ3ä¸ªæœˆ+ï¼‰

1. **åŠŸèƒ½æ‰©å±•**
   - å¤šè¯­è¨€æ”¯æŒ
   - ç§»åŠ¨ç«¯API
   - æ•°æ®åˆ†æçœ‹æ¿

2. **æ¶æ„ä¼˜åŒ–**
   - å¾®æœåŠ¡æ‹†åˆ†
   - Redisç¼“å­˜
   - æ¶ˆæ¯é˜Ÿåˆ—

3. **è¿ç»´æå‡**
   - è‡ªåŠ¨åŒ–éƒ¨ç½²
   - ç°åº¦å‘å¸ƒ
   - å®¹å™¨åŒ–

---

## ğŸ“ è”ç³»ä¿¡æ¯

**é¡¹ç›®åç§°**ï¼šAimLab å°„å‡»è®­ç»ƒæ¯”èµ›ç³»ç»Ÿ  
**è°ƒè¯•å·¥å…·**ï¼šMCP (Model Context Protocol)  
**æŠ¥å‘Šç‰ˆæœ¬**ï¼š1.0  
**æœ€åæ›´æ–°**ï¼š2025-10-27

---

**æ„Ÿè°¢ä½¿ç”¨ MCP å·¥å…·è¿›è¡Œç³»ç»Ÿè°ƒè¯•ï¼**

æœ¬æŠ¥å‘Šå±•ç¤ºäº† MCP å·¥å…·åœ¨å®é™…é¡¹ç›®ä¸­çš„å¼ºå¤§èƒ½åŠ›ï¼š
- âœ… å¿«é€Ÿå®šä½é—®é¢˜
- âœ… è‡ªåŠ¨åŒ–æµ‹è¯•
- âœ… è¯¦ç»†çš„æŠ¥å‘Šç”Ÿæˆ
- âœ… ä»£ç ä¿®å¤éªŒè¯

MCP å·¥å…·å°†æŒç»­æå‡å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡ï¼ğŸš€


